<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Hardin â€“ Åžehir AnÄ± AlbÃ¼mÃ¼n</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root {
      --bg: #f6f4f1;
      --card-bg: #ffffff;
      --text: #2d3029;
      --accent: #745e4d;
      --accent-soft: #e3dfd8;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    /* ÃœST BAR */
    .topbar {
      width: 100%;
      padding: 10px 16px;
      background: #2d3029;
      color: #f6f4f1;
      display: flex;
      align-items: center;
      justify-content: center;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .topbar-title {
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      font-size: 0.9rem;
    }

    .page {
      max-width: 960px;
      margin: 18px auto 32px;
      padding: 0 14px;
    }

    .card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 18px 16px 20px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.06);
      border: 1px solid rgba(0,0,0,0.04);
    }

    h1 {
      margin: 0 0 6px;
      font-size: 1.4rem;
    }

    .subtitle {
      font-size: 0.9rem;
      margin: 0 0 10px;
      line-height: 1.45;
    }

    .note {
      font-size: 0.78rem;
      color: #7a7a7a;
      margin-bottom: 14px;
    }

    .btn-row {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .btn {
      border-radius: 999px;
      padding: 10px 18px;
      font-size: 0.95rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.12s ease;
      border: none;
      text-decoration: none;
    }

    .btn-primary {
      background: var(--accent);
      color: #fff;
      box-shadow: 0 4px 12px rgba(0,0,0,0.18);
    }

    .btn-primary:active {
      transform: translateY(1px);
      box-shadow: 0 2px 6px rgba(0,0,0,0.16);
    }

    .btn-secondary {
      background: var(--accent-soft);
      color: var(--text);
    }

    .btn-secondary:active {
      transform: translateY(1px);
    }

    .btn-emoji {
      font-size: 1rem;
    }

    .counter {
      font-size: 0.8rem;
      color: #777;
      margin-top: 6px;
    }

    #photos {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
      gap: 10px;
      margin-top: 16px;
    }

    .photo {
      position: relative;
      border-radius: 14px;
      overflow: hidden;
      background: #d9d9d9;
      aspect-ratio: 3 / 4;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }

    .photo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .delete {
      position: absolute;
      top: 6px;
      right: 6px;
      background: rgba(0,0,0,0.6);
      width: 26px;
      height: 26px;
      border-radius: 999px;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 15px;
      cursor: pointer;
      backdrop-filter: blur(3px);
    }

    .empty {
      margin-top: 10px;
      color: #777;
      font-size: 0.86rem;
    }

    #fileInput {
      display: none;
    }

    @media (min-width: 768px) {
      .card {
        padding: 22px 22px 24px;
      }
      h1 {
        font-size: 1.6rem;
      }
    }
  </style>
</head>
<body>

  <div class="topbar">
    <div class="topbar-title">HARDÄ°N â€¢ AKILLI ANI MAGNETÄ°</div>
  </div>

  <div class="page">
    <div class="card">
      <h1>Åžehir AnÄ± AlbÃ¼mÃ¼n</h1>
      <p class="subtitle">
        Bu magneti her okuttuÄŸunda, buraya eklediÄŸin fotoÄŸraflardan oluÅŸan
        <strong>sana Ã¶zel</strong> albÃ¼m gÃ¶rÃ¼nÃ¼r.
      </p>
      <p class="note">
        FotoÄŸraflarÄ±n bu cihazda saklanÄ±r; internete yÃ¼klenmez veya baÅŸkalarÄ±yla paylaÅŸÄ±lmaz.
      </p>

      <div class="btn-row">
        <!-- BUTON ARTIK LABEL, DOÄžRUDAN fileInput'A BAÄžLI -->
        <label class="btn btn-primary" for="fileInput">
          <span class="btn-emoji">ðŸ“¸</span>
          <span>FotoÄŸraf Ekle</span>
        </label>

        <button class="btn btn-secondary" type="button" onclick="clearAllPhotos()">
          ðŸ§¹ AlbÃ¼mÃ¼ Temizle
        </button>
      </div>

      <div id="counter" class="counter"></div>

      <input id="fileInput" type="file" accept="image/*" multiple>

      <div id="photos"></div>
      <div id="emptyMsg" class="empty"></div>
    </div>
  </div>

  <script>
  const ALBUM_KEY = "hardin_deneme_album_v1";
  const MAX_PHOTOS = 20; // gÃ¼venli Ã¼st sÄ±nÄ±r (istersen sonra 15 / 25 yapabilirsin)

  let photos = JSON.parse(localStorage.getItem(ALBUM_KEY)) || [];

  function savePhotos() {
    try {
      localStorage.setItem(ALBUM_KEY, JSON.stringify(photos));
      return true;
    } catch (e) {
      alert("AlbÃ¼m telefon hafÄ±zasÄ±nda izin verilen sÄ±nÄ±ra ulaÅŸtÄ±. Yeni fotoÄŸraf eklemek iÃ§in Ã¶nce bazÄ±larÄ±nÄ± silmen gerekiyor.");
      console.error(e);
      return false;
    }
  }

  function updateCounter() {
    const counterEl = document.getElementById("counter");
    if (photos.length === 0) {
      counterEl.innerText = "";
    } else if (photos.length === 1) {
      counterEl.innerText = "AlbÃ¼mÃ¼nde 1 fotoÄŸraf var.";
    } else {
      counterEl.innerText = "AlbÃ¼mÃ¼nde " + photos.length + " fotoÄŸraf var.";
    }
  }

  function render() {
    const container = document.getElementById("photos");
    const empty = document.getElementById("emptyMsg");

    container.innerHTML = "";

    if (photos.length === 0) {
      empty.innerText = "HenÃ¼z fotoÄŸraf eklenmedi. BaÅŸlamak iÃ§in yukarÄ±daki butona dokun.";
    } else {
      empty.innerText = "";
    }

    photos.forEach((src, index) => {
      const div = document.createElement("div");
      div.className = "photo";

      const img = document.createElement("img");
      img.src = src;

      const del = document.createElement("div");
      del.className = "delete";
      del.innerText = "Ã—";
      del.onclick = () => {
        photos.splice(index, 1);
        savePhotos();
        render();
        updateCounter();
      };

      div.appendChild(img);
      div.appendChild(del);
      container.appendChild(div);
    });

    updateCounter();
  }

  // SeÃ§ilen fotoÄŸrafÄ± kÃ¼Ã§Ã¼ltÃ¼p kaydeden fonksiyon
  function addFileCompressed(file) {
    if (photos.length >= MAX_PHOTOS) {
      alert("Bu albÃ¼m en fazla " + MAX_PHOTOS + " fotoÄŸraf saklayabilir. Yeni fotoÄŸraf eklemek iÃ§in Ã¶nce bazÄ±larÄ±nÄ± sil.");
      return;
    }

    const reader = new FileReader();
    reader.onload = () => {
      const img = new Image();
      img.onload = () => {
        const maxSize = 960; // Ã¶nceki 1280'e gÃ¶re biraz daha kÃ¼Ã§Ã¼k
        let w = img.width;
        let h = img.height;

        const scale = Math.min(maxSize / w, maxSize / h, 1);
        w = Math.round(w * scale);
        h = Math.round(h * scale);

        const canvas = document.createElement("canvas");
        canvas.width = w;
        canvas.height = h;
        const ctx = canvas.getContext("2d");
        ctx.drawImage(img, 0, 0, w, h);

        // kaliteyi 0.7 yaptÄ±k â†’ boyut kÃ¼Ã§Ã¼lÃ¼r, daha Ã§ok foto sÄ±ÄŸar
        const dataUrl = canvas.toDataURL("image/jpeg", 0.7);

        // Ã¶nce diziye ekle, sonra kaydetmeyi dene
        photos.push(dataUrl);
        if (!savePhotos()) {
          // kaydedemezsek son eklediÄŸimizi geri al
          photos.pop();
        }
        render();
      };
      img.src = reader.result;
    };
    reader.readAsDataURL(file);
  }

  document.getElementById("fileInput").addEventListener("change", function() {
    const files = Array.from(this.files);
    files.forEach(file => addFileCompressed(file));
    this.value = "";
  });

  function clearAllPhotos() {
    if (!photos.length) return;
    const ok = confirm("TÃ¼m fotoÄŸraflarÄ± silmek istediÄŸinden emin misin?");
    if (!ok) return;
    photos = [];
    savePhotos();
    render();
  }

  render();
</script>
</body>
</html>

